FROM node:18.12.1-alpine

ENV HOME=/home/app
ENV PATH=/home/app/src/node_modules/.bin:$PATH
ENV NODE_ENV production

EXPOSE 8080

WORKDIR $HOME/src

RUN apk add --update \
  git \
  make \
  gcc \
  libpng-dev \
  autoconf \
  automake \
  make \
  g++ \
  libtool \
  nasm

COPY package.json $HOME/src/
RUN npm install

COPY . $HOME/src

CMD ["npm", "run", "dev"]
